function buildMustache(path, params, hash, raw, loc) {
    if (typeof path === 'string') {
        path = buildPath(path);
    }
    return {
        type: 'MustacheStatement',
        path,
        params: params || [],
        hash: hash || buildHash([]),
        escaped: !raw,
        loc: buildLoc(loc || null)
    };
}
function buildBlock(path, params, hash, program, inverse, loc) {
    return {
        type: 'BlockStatement',
        path: buildPath(path),
        params: params || [],
        hash: hash || buildHash([]),
        program: program || null,
        inverse: inverse || null,
        loc: buildLoc(loc || null)
    };
}
function buildElementModifier(path, params, hash, loc) {
    return {
        type: 'ElementModifierStatement',
        path: buildPath(path),
        params: params || [],
        hash: hash || buildHash([]),
        loc: buildLoc(loc || null)
    };
}
function buildPartial(name, params, hash, indent, loc) {
    return {
        type: 'PartialStatement',
        name: name,
        params: params || [],
        hash: hash || buildHash([]),
        indent: indent || '',
        strip: { open: false, close: false },
        loc: buildLoc(loc || null)
    };
}
function buildComment(value, loc) {
    return {
        type: 'CommentStatement',
        value: value,
        loc: buildLoc(loc || null)
    };
}
function buildMustacheComment(value, loc) {
    return {
        type: 'MustacheCommentStatement',
        value: value,
        loc: buildLoc(loc || null)
    };
}
function buildConcat(parts, loc) {
    return {
        type: 'ConcatStatement',
        parts: parts || [],
        loc: buildLoc(loc || null)
    };
}
function buildElement(tag, attributes, modifiers, children, comments, blockParams, loc) {
    // this is used for backwards compat prior to `blockParams` being added to the AST
    if (Array.isArray(comments)) {
        if (isBlockParms(comments)) {
            blockParams = comments;
            comments = [];
        } else if (isLoc(blockParams)) {
            loc = blockParams;
            blockParams = [];
        }
    } else if (isLoc(comments)) {
        // this is used for backwards compat prior to `comments` being added to the AST
        loc = comments;
        comments = [];
    } else if (isLoc(blockParams)) {
        loc = blockParams;
        blockParams = [];
    }
    // this is used for backwards compat, prior to `selfClosing` being part of the ElementNode AST
    let selfClosing = false;
    if (typeof tag === 'object') {
        selfClosing = tag.selfClosing;
        tag = tag.name;
    }
    return {
        type: 'ElementNode',
        tag: tag || '',
        selfClosing: selfClosing,
        attributes: attributes || [],
        blockParams: blockParams || [],
        modifiers: modifiers || [],
        comments: comments || [],
        children: children || [],
        loc: buildLoc(loc || null)
    };
}
function buildAttr(name, value, loc) {
    return {
        type: 'AttrNode',
        name: name,
        value: value,
        loc: buildLoc(loc || null)
    };
}
function buildText(chars, loc) {
    return {
        type: 'TextNode',
        chars: chars || '',
        loc: buildLoc(loc || null)
    };
}
// Expressions
function buildSexpr(path, params, hash, loc) {
    return {
        type: 'SubExpression',
        path: buildPath(path),
        params: params || [],
        hash: hash || buildHash([]),
        loc: buildLoc(loc || null)
    };
}
function buildPath(original, loc) {
    if (typeof original !== 'string') return original;
    let parts = original.split('.');
    let thisHead = false;
    if (parts[0] === 'this') {
        thisHead = true;
        parts = parts.slice(1);
    }
    return {
        type: 'PathExpression',
        original,
        this: thisHead,
        parts,
        data: false,
        loc: buildLoc(loc || null)
    };
}
function buildLiteral(type, value, loc) {
    return {
        type,
        value,
        original: value,
        loc: buildLoc(loc || null)
    };
}
// Miscellaneous
function buildHash(pairs, loc) {
    return {
        type: 'Hash',
        pairs: pairs || [],
        loc: buildLoc(loc || null)
    };
}
function buildPair(key, value, loc) {
    return {
        type: 'HashPair',
        key: key,
        value,
        loc: buildLoc(loc || null)
    };
}
function buildProgram(body, blockParams, loc) {
    return {
        type: 'Program',
        body: body || [],
        blockParams: blockParams || [],
        loc: buildLoc(loc || null)
    };
}
function buildSource(source) {
    return source || null;
}
function buildPosition(line, column) {
    return {
        line,
        column
    };
}
export const SYNTHETIC = {
    source: '(synthetic)',
    start: { line: 1, column: 0 },
    end: { line: 1, column: 0 }
};
function buildLoc(...args) {
    if (args.length === 1) {
        let loc = args[0];
        if (loc && typeof loc === 'object') {
            return {
                source: buildSource(loc.source),
                start: buildPosition(loc.start.line, loc.start.column),
                end: buildPosition(loc.end.line, loc.end.column)
            };
        } else {
            return SYNTHETIC;
        }
    } else {
        let [startLine, startColumn, endLine, endColumn, source] = args;
        return {
            source: buildSource(source),
            start: buildPosition(startLine, startColumn),
            end: buildPosition(endLine, endColumn)
        };
    }
}
function isBlockParms(arr) {
    return arr[0] === 'string';
}
function isLoc(item) {
    return !Array.isArray(item);
}
export default {
    mustache: buildMustache,
    block: buildBlock,
    partial: buildPartial,
    comment: buildComment,
    mustacheComment: buildMustacheComment,
    element: buildElement,
    elementModifier: buildElementModifier,
    attr: buildAttr,
    text: buildText,
    sexpr: buildSexpr,
    path: buildPath,
    concat: buildConcat,
    hash: buildHash,
    pair: buildPair,
    literal: buildLiteral,
    program: buildProgram,
    loc: buildLoc,
    pos: buildPosition,
    string: literal('StringLiteral'),
    boolean: literal('BooleanLiteral'),
    number: literal('NumberLiteral'),
    undefined() {
        return buildLiteral('UndefinedLiteral', undefined);
    },
    null() {
        return buildLiteral('NullLiteral', null);
    }
};
function literal(type) {
    return function (value) {
        return buildLiteral(type, value);
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGRlcnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wYWNrYWdlcy9AZ2xpbW1lci9zeW50YXgvbGliL2J1aWxkZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVFBLFNBQVMsQUFBYSxjQUNwQixBQUErQixNQUMvQixBQUF5QixRQUN6QixBQUFlLE1BQ2YsQUFBYSxLQUNiLEFBQXdCO0FBRXhCLFFBQUksT0FBTyxBQUFJLFNBQUssQUFBUSxVQUFFO0FBQzVCLEFBQUksZUFBRyxBQUFTLFVBQUMsQUFBSSxBQUFDLEFBQUM7QUFDeEI7QUFFRDtBQUNFLEFBQUksY0FBRSxBQUFtQjtBQUN6QixBQUFJO0FBQ0osQUFBTSxnQkFBRSxBQUFNLFVBQUksQUFBRTtBQUNwQixBQUFJLGNBQUUsQUFBSSxRQUFJLEFBQVMsVUFBQyxBQUFFLEFBQUM7QUFDM0IsQUFBTyxpQkFBRSxDQUFDLEFBQUc7QUFDYixBQUFHLGFBQUUsQUFBUSxTQUFDLEFBQUcsT0FBSSxBQUFJLEFBQUMsQUFDM0IsQUFBQyxBQUNKO0FBUlM7QUFRUjtBQUVELFNBQVMsQUFBVSxXQUNqQixBQUFpQixNQUNqQixBQUFnQyxRQUNoQyxBQUFzQixNQUN0QixBQUFvQixTQUNwQixBQUE2QixTQUM3QixBQUF3QjtBQUV4QjtBQUNFLEFBQUksY0FBRSxBQUFnQjtBQUN0QixBQUFJLGNBQUUsQUFBUyxVQUFDLEFBQUksQUFBQztBQUNyQixBQUFNLGdCQUFFLEFBQU0sVUFBSSxBQUFFO0FBQ3BCLEFBQUksY0FBRSxBQUFJLFFBQUksQUFBUyxVQUFDLEFBQUUsQUFBQztBQUMzQixBQUFPLGlCQUFFLEFBQU8sV0FBSSxBQUFJO0FBQ3hCLEFBQU8saUJBQUUsQUFBTyxXQUFJLEFBQUk7QUFDeEIsQUFBRyxhQUFFLEFBQVEsU0FBQyxBQUFHLE9BQUksQUFBSSxBQUFDLEFBQzNCLEFBQUMsQUFDSjtBQVRTO0FBU1I7QUFFRCxTQUFTLEFBQW9CLHFCQUMzQixBQUFpQixN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VztBQUNuQixBQUFJLFVBQUUsQUFBUztBQUNmLEFBQUksVUFBRSxBQUFTO0FBQ2YsQUFBTyxhQUFFLEFBQVk7QUFDckIsQUFBTyxhQUFFLEFBQVk7QUFDckIsQUFBRyxTQUFFLEFBQVE7QUFDYixBQUFHLFNBQUUsQUFBYTtBQUVsQixBQUFNLFlBQUUsQUFBTyxRQUFDLEFBQWUsQUFBQztBQUNoQyxBQUFPLGFBQUUsQUFBTyxRQUFDLEFBQWdCLEFBQUM7QUFDbEMsQUFBTSxZQUFFLEFBQU8sUUFBQyxBQUFlLEFBQUM7QUFDaEMsQUFBUztBQUNQLGVBQU8sQUFBWSxhQUFDLEFBQWtCLG9CQUFFLEFBQVMsQUFBQyxBQUFDLEFBQ3JEO0FBQUM7QUFDRCxBQUFJO0FBQ0YsZUFBTyxBQUFZLGFBQUMsQUFBYSxlQUFFLEFBQUksQUFBQyxBQUFDLEFBQzNDO0FBQUMsQUFDRixBQUFDO0FBN0JhO0FBK0JmLFNBQVMsQUFBTyxRQUF3QixBQUFlO0FBQ3JELFdBQU8sVUFBUyxBQUFpQjtBQUMvQixlQUFPLEFBQVksYUFBQyxBQUFJLE1BQUUsQUFBSyxBQUFDLEFBQUMsQUFDbkM7QUFBQyxBQUFDLEFBQ0o7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEFTVCBmcm9tICcuL3R5cGVzL25vZGVzJztcbmltcG9ydCB7IE9wdGlvbiB9IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuXG4vLyBTdGF0ZW1lbnRzXG5cbmV4cG9ydCB0eXBlIEJ1aWxkZXJQYXRoID0gc3RyaW5nIHwgQVNULlBhdGhFeHByZXNzaW9uO1xuZXhwb3J0IHR5cGUgVGFnRGVzY3JpcHRvciA9IHN0cmluZyB8IHsgbmFtZTogc3RyaW5nOyBzZWxmQ2xvc2luZzogYm9vbGVhbiB9O1xuXG5mdW5jdGlvbiBidWlsZE11c3RhY2hlKFxuICBwYXRoOiBCdWlsZGVyUGF0aCB8IEFTVC5MaXRlcmFsLFxuICBwYXJhbXM/OiBBU1QuRXhwcmVzc2lvbltdLFxuICBoYXNoPzogQVNULkhhc2gsXG4gIHJhdz86IGJvb2xlYW4sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULk11c3RhY2hlU3RhdGVtZW50IHtcbiAgaWYgKHR5cGVvZiBwYXRoID09PSAnc3RyaW5nJykge1xuICAgIHBhdGggPSBidWlsZFBhdGgocGF0aCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHR5cGU6ICdNdXN0YWNoZVN0YXRlbWVudCcsXG4gICAgcGF0aCxcbiAgICBwYXJhbXM6IHBhcmFtcyB8fCBbXSxcbiAgICBoYXNoOiBoYXNoIHx8IGJ1aWxkSGFzaChbXSksXG4gICAgZXNjYXBlZDogIXJhdyxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRCbG9jayhcbiAgcGF0aDogQnVpbGRlclBhdGgsXG4gIHBhcmFtczogT3B0aW9uPEFTVC5FeHByZXNzaW9uW10+LFxuICBoYXNoOiBPcHRpb248QVNULkhhc2g+LFxuICBwcm9ncmFtOiBBU1QuUHJvZ3JhbSxcbiAgaW52ZXJzZT86IE9wdGlvbjxBU1QuUHJvZ3JhbT4sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULkJsb2NrU3RhdGVtZW50IHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnQmxvY2tTdGF0ZW1lbnQnLFxuICAgIHBhdGg6IGJ1aWxkUGF0aChwYXRoKSxcbiAgICBwYXJhbXM6IHBhcmFtcyB8fCBbXSxcbiAgICBoYXNoOiBoYXNoIHx8IGJ1aWxkSGFzaChbXSksXG4gICAgcHJvZ3JhbTogcHJvZ3JhbSB8fCBudWxsLFxuICAgIGludmVyc2U6IGludmVyc2UgfHwgbnVsbCxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRFbGVtZW50TW9kaWZpZXIoXG4gIHBhdGg6IEJ1aWxkZXJQYXRoLFxuICBwYXJhbXM/OiBBU1QuRXhwcmVzc2lvbltdLFxuICBoYXNoPzogQVNULkhhc2gsXG4gIGxvYz86IE9wdGlvbjxBU1QuU291cmNlTG9jYXRpb24+XG4pOiBBU1QuRWxlbWVudE1vZGlmaWVyU3RhdGVtZW50IHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnRWxlbWVudE1vZGlmaWVyU3RhdGVtZW50JyxcbiAgICBwYXRoOiBidWlsZFBhdGgocGF0aCksXG4gICAgcGFyYW1zOiBwYXJhbXMgfHwgW10sXG4gICAgaGFzaDogaGFzaCB8fCBidWlsZEhhc2goW10pLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZFBhcnRpYWwoXG4gIG5hbWU6IEFTVC5QYXRoRXhwcmVzc2lvbixcbiAgcGFyYW1zPzogQVNULkV4cHJlc3Npb25bXSxcbiAgaGFzaD86IEFTVC5IYXNoLFxuICBpbmRlbnQ/OiBzdHJpbmcsXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULlBhcnRpYWxTdGF0ZW1lbnQge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdQYXJ0aWFsU3RhdGVtZW50JyxcbiAgICBuYW1lOiBuYW1lLFxuICAgIHBhcmFtczogcGFyYW1zIHx8IFtdLFxuICAgIGhhc2g6IGhhc2ggfHwgYnVpbGRIYXNoKFtdKSxcbiAgICBpbmRlbnQ6IGluZGVudCB8fCAnJyxcbiAgICBzdHJpcDogeyBvcGVuOiBmYWxzZSwgY2xvc2U6IGZhbHNlIH0sXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkQ29tbWVudCh2YWx1ZTogc3RyaW5nLCBsb2M/OiBBU1QuU291cmNlTG9jYXRpb24pOiBBU1QuQ29tbWVudFN0YXRlbWVudCB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0NvbW1lbnRTdGF0ZW1lbnQnLFxuICAgIHZhbHVlOiB2YWx1ZSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRNdXN0YWNoZUNvbW1lbnQoXG4gIHZhbHVlOiBzdHJpbmcsXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULk11c3RhY2hlQ29tbWVudFN0YXRlbWVudCB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ011c3RhY2hlQ29tbWVudFN0YXRlbWVudCcsXG4gICAgdmFsdWU6IHZhbHVlLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZENvbmNhdChcbiAgcGFydHM6IChBU1QuVGV4dE5vZGUgfCBBU1QuTXVzdGFjaGVTdGF0ZW1lbnQpW10sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULkNvbmNhdFN0YXRlbWVudCB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0NvbmNhdFN0YXRlbWVudCcsXG4gICAgcGFydHM6IHBhcnRzIHx8IFtdLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG4vLyBOb2Rlc1xuXG5mdW5jdGlvbiBidWlsZEVsZW1lbnQoXG4gIHRhZzogVGFnRGVzY3JpcHRvcixcbiAgYXR0cmlidXRlcz86IEFTVC5BdHRyTm9kZVtdLFxuICBtb2RpZmllcnM/OiBBU1QuRWxlbWVudE1vZGlmaWVyU3RhdGVtZW50W10sXG4gIGNoaWxkcmVuPzogQVNULlN0YXRlbWVudFtdLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5FbGVtZW50Tm9kZTtcbmZ1bmN0aW9uIGJ1aWxkRWxlbWVudChcbiAgdGFnOiBUYWdEZXNjcmlwdG9yLFxuICBhdHRyaWJ1dGVzPzogQVNULkF0dHJOb2RlW10sXG4gIG1vZGlmaWVycz86IEFTVC5FbGVtZW50TW9kaWZpZXJTdGF0ZW1lbnRbXSxcbiAgY2hpbGRyZW4/OiBBU1QuU3RhdGVtZW50W10sXG4gIGNvbW1lbnRzPzogQVNULk11c3RhY2hlQ29tbWVudFN0YXRlbWVudFtdLFxuICBibG9ja1BhcmFtcz86IHN0cmluZ1tdLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5FbGVtZW50Tm9kZTtcblxuZnVuY3Rpb24gYnVpbGRFbGVtZW50KFxuICB0YWc6IFRhZ0Rlc2NyaXB0b3IsXG4gIGF0dHJpYnV0ZXM/OiBBU1QuQXR0ck5vZGVbXSxcbiAgbW9kaWZpZXJzPzogQVNULkVsZW1lbnRNb2RpZmllclN0YXRlbWVudFtdLFxuICBjaGlsZHJlbj86IEFTVC5TdGF0ZW1lbnRbXSxcbiAgY29tbWVudHM/OiBBU1QuTXVzdGFjaGVDb21tZW50U3RhdGVtZW50W10gfCBBU1QuU291cmNlTG9jYXRpb24gfCBzdHJpbmdbXSxcbiAgYmxvY2tQYXJhbXM/OiBzdHJpbmdbXSxcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuRWxlbWVudE5vZGUge1xuICAvLyB0aGlzIGlzIHVzZWQgZm9yIGJhY2t3YXJkcyBjb21wYXQgcHJpb3IgdG8gYGJsb2NrUGFyYW1zYCBiZWluZyBhZGRlZCB0byB0aGUgQVNUXG4gIGlmIChBcnJheS5pc0FycmF5KGNvbW1lbnRzKSkge1xuICAgIGlmIChpc0Jsb2NrUGFybXMoY29tbWVudHMpKSB7XG4gICAgICBibG9ja1BhcmFtcyA9IGNvbW1lbnRzO1xuICAgICAgY29tbWVudHMgPSBbXTtcbiAgICB9IGVsc2UgaWYgKGlzTG9jKGJsb2NrUGFyYW1zKSkge1xuICAgICAgbG9jID0gYmxvY2tQYXJhbXM7XG4gICAgICBibG9ja1BhcmFtcyA9IFtdO1xuICAgIH1cbiAgfSBlbHNlIGlmIChpc0xvYyhjb21tZW50cykpIHtcbiAgICAvLyB0aGlzIGlzIHVzZWQgZm9yIGJhY2t3YXJkcyBjb21wYXQgcHJpb3IgdG8gYGNvbW1lbnRzYCBiZWluZyBhZGRlZCB0byB0aGUgQVNUXG4gICAgbG9jID0gY29tbWVudHM7XG4gICAgY29tbWVudHMgPSBbXTtcbiAgfSBlbHNlIGlmIChpc0xvYyhibG9ja1BhcmFtcykpIHtcbiAgICBsb2MgPSBibG9ja1BhcmFtcztcbiAgICBibG9ja1BhcmFtcyA9IFtdO1xuICB9XG5cbiAgLy8gdGhpcyBpcyB1c2VkIGZvciBiYWNrd2FyZHMgY29tcGF0LCBwcmlvciB0byBgc2VsZkNsb3NpbmdgIGJlaW5nIHBhcnQgb2YgdGhlIEVsZW1lbnROb2RlIEFTVFxuICBsZXQgc2VsZkNsb3NpbmcgPSBmYWxzZTtcbiAgaWYgKHR5cGVvZiB0YWcgPT09ICdvYmplY3QnKSB7XG4gICAgc2VsZkNsb3NpbmcgPSB0YWcuc2VsZkNsb3Npbmc7XG4gICAgdGFnID0gdGFnLm5hbWU7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHR5cGU6ICdFbGVtZW50Tm9kZScsXG4gICAgdGFnOiB0YWcgfHwgJycsXG4gICAgc2VsZkNsb3Npbmc6IHNlbGZDbG9zaW5nLFxuICAgIGF0dHJpYnV0ZXM6IGF0dHJpYnV0ZXMgfHwgW10sXG4gICAgYmxvY2tQYXJhbXM6IGJsb2NrUGFyYW1zIHx8IFtdLFxuICAgIG1vZGlmaWVyczogbW9kaWZpZXJzIHx8IFtdLFxuICAgIGNvbW1lbnRzOiAoY29tbWVudHMgYXMgQVNULk11c3RhY2hlQ29tbWVudFN0YXRlbWVudFtdKSB8fCBbXSxcbiAgICBjaGlsZHJlbjogY2hpbGRyZW4gfHwgW10sXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJ1aWxkQXR0cihcbiAgbmFtZTogc3RyaW5nLFxuICB2YWx1ZTogQVNULkF0dHJOb2RlWyd2YWx1ZSddLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5BdHRyTm9kZSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ0F0dHJOb2RlJyxcbiAgICBuYW1lOiBuYW1lLFxuICAgIHZhbHVlOiB2YWx1ZSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRUZXh0KGNoYXJzPzogc3RyaW5nLCBsb2M/OiBBU1QuU291cmNlTG9jYXRpb24pOiBBU1QuVGV4dE5vZGUge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdUZXh0Tm9kZScsXG4gICAgY2hhcnM6IGNoYXJzIHx8ICcnLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG4vLyBFeHByZXNzaW9uc1xuXG5mdW5jdGlvbiBidWlsZFNleHByKFxuICBwYXRoOiBCdWlsZGVyUGF0aCxcbiAgcGFyYW1zPzogQVNULkV4cHJlc3Npb25bXSxcbiAgaGFzaD86IEFTVC5IYXNoLFxuICBsb2M/OiBBU1QuU291cmNlTG9jYXRpb25cbik6IEFTVC5TdWJFeHByZXNzaW9uIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnU3ViRXhwcmVzc2lvbicsXG4gICAgcGF0aDogYnVpbGRQYXRoKHBhdGgpLFxuICAgIHBhcmFtczogcGFyYW1zIHx8IFtdLFxuICAgIGhhc2g6IGhhc2ggfHwgYnVpbGRIYXNoKFtdKSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRQYXRoKG9yaWdpbmFsOiBCdWlsZGVyUGF0aCwgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uKTogQVNULlBhdGhFeHByZXNzaW9uIHtcbiAgaWYgKHR5cGVvZiBvcmlnaW5hbCAhPT0gJ3N0cmluZycpIHJldHVybiBvcmlnaW5hbDtcblxuICBsZXQgcGFydHMgPSBvcmlnaW5hbC5zcGxpdCgnLicpO1xuICBsZXQgdGhpc0hlYWQgPSBmYWxzZTtcblxuICBpZiAocGFydHNbMF0gPT09ICd0aGlzJykge1xuICAgIHRoaXNIZWFkID0gdHJ1ZTtcbiAgICBwYXJ0cyA9IHBhcnRzLnNsaWNlKDEpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnUGF0aEV4cHJlc3Npb24nLFxuICAgIG9yaWdpbmFsLFxuICAgIHRoaXM6IHRoaXNIZWFkLFxuICAgIHBhcnRzLFxuICAgIGRhdGE6IGZhbHNlLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZExpdGVyYWw8VCBleHRlbmRzIEFTVC5MaXRlcmFsPihcbiAgdHlwZTogVFsndHlwZSddLFxuICB2YWx1ZTogVFsndmFsdWUnXSxcbiAgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uXG4pOiBBU1QuTGl0ZXJhbCB7XG4gIHJldHVybiB7XG4gICAgdHlwZSxcbiAgICB2YWx1ZSxcbiAgICBvcmlnaW5hbDogdmFsdWUsXG4gICAgbG9jOiBidWlsZExvYyhsb2MgfHwgbnVsbCksXG4gIH0gYXMgQVNULkxpdGVyYWw7XG59XG5cbi8vIE1pc2NlbGxhbmVvdXNcblxuZnVuY3Rpb24gYnVpbGRIYXNoKHBhaXJzPzogQVNULkhhc2hQYWlyW10sIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvbik6IEFTVC5IYXNoIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnSGFzaCcsXG4gICAgcGFpcnM6IHBhaXJzIHx8IFtdLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZFBhaXIoa2V5OiBzdHJpbmcsIHZhbHVlOiBBU1QuRXhwcmVzc2lvbiwgbG9jPzogQVNULlNvdXJjZUxvY2F0aW9uKTogQVNULkhhc2hQYWlyIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnSGFzaFBhaXInLFxuICAgIGtleToga2V5LFxuICAgIHZhbHVlLFxuICAgIGxvYzogYnVpbGRMb2MobG9jIHx8IG51bGwpLFxuICB9O1xufVxuXG5mdW5jdGlvbiBidWlsZFByb2dyYW0oXG4gIGJvZHk/OiBBU1QuU3RhdGVtZW50W10sXG4gIGJsb2NrUGFyYW1zPzogc3RyaW5nW10sXG4gIGxvYz86IEFTVC5Tb3VyY2VMb2NhdGlvblxuKTogQVNULlByb2dyYW0ge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdQcm9ncmFtJyxcbiAgICBib2R5OiBib2R5IHx8IFtdLFxuICAgIGJsb2NrUGFyYW1zOiBibG9ja1BhcmFtcyB8fCBbXSxcbiAgICBsb2M6IGJ1aWxkTG9jKGxvYyB8fCBudWxsKSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gYnVpbGRTb3VyY2Uoc291cmNlPzogc3RyaW5nKSB7XG4gIHJldHVybiBzb3VyY2UgfHwgbnVsbDtcbn1cblxuZnVuY3Rpb24gYnVpbGRQb3NpdGlvbihsaW5lOiBudW1iZXIsIGNvbHVtbjogbnVtYmVyKSB7XG4gIHJldHVybiB7XG4gICAgbGluZSxcbiAgICBjb2x1bW4sXG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBTWU5USEVUSUM6IEFTVC5Tb3VyY2VMb2NhdGlvbiA9IHtcbiAgc291cmNlOiAnKHN5bnRoZXRpYyknLFxuICBzdGFydDogeyBsaW5lOiAxLCBjb2x1bW46IDAgfSxcbiAgZW5kOiB7IGxpbmU6IDEsIGNvbHVtbjogMCB9LFxufTtcblxuZnVuY3Rpb24gYnVpbGRMb2MobG9jOiBPcHRpb248QVNULlNvdXJjZUxvY2F0aW9uPik6IEFTVC5Tb3VyY2VMb2NhdGlvbjtcbmZ1bmN0aW9uIGJ1aWxkTG9jKFxuICBzdGFydExpbmU6IG51bWJlcixcbiAgc3RhcnRDb2x1bW46IG51bWJlcixcbiAgZW5kTGluZT86IG51bWJlcixcbiAgZW5kQ29sdW1uPzogbnVtYmVyLFxuICBzb3VyY2U/OiBzdHJpbmdcbik6IEFTVC5Tb3VyY2VMb2NhdGlvbjtcblxuZnVuY3Rpb24gYnVpbGRMb2MoLi4uYXJnczogYW55W10pOiBBU1QuU291cmNlTG9jYXRpb24ge1xuICBpZiAoYXJncy5sZW5ndGggPT09IDEpIHtcbiAgICBsZXQgbG9jID0gYXJnc1swXTtcblxuICAgIGlmIChsb2MgJiYgdHlwZW9mIGxvYyA9PT0gJ29iamVjdCcpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHNvdXJjZTogYnVpbGRTb3VyY2UobG9jLnNvdXJjZSksXG4gICAgICAgIHN0YXJ0OiBidWlsZFBvc2l0aW9uKGxvYy5zdGFydC5saW5lLCBsb2Muc3RhcnQuY29sdW1uKSxcbiAgICAgICAgZW5kOiBidWlsZFBvc2l0aW9uKGxvYy5lbmQubGluZSwgbG9jLmVuZC5jb2x1bW4pLFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFNZTlRIRVRJQztcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbGV0IFtzdGFydExpbmUsIHN0YXJ0Q29sdW1uLCBlbmRMaW5lLCBlbmRDb2x1bW4sIHNvdXJjZV0gPSBhcmdzO1xuICAgIHJldHVybiB7XG4gICAgICBzb3VyY2U6IGJ1aWxkU291cmNlKHNvdXJjZSksXG4gICAgICBzdGFydDogYnVpbGRQb3NpdGlvbihzdGFydExpbmUsIHN0YXJ0Q29sdW1uKSxcbiAgICAgIGVuZDogYnVpbGRQb3NpdGlvbihlbmRMaW5lLCBlbmRDb2x1bW4pLFxuICAgIH07XG4gIH1cbn1cblxuZnVuY3Rpb24gaXNCbG9ja1Bhcm1zKGFycjogc3RyaW5nW10gfCBBU1QuTXVzdGFjaGVDb21tZW50U3RhdGVtZW50W10pOiBhcnIgaXMgc3RyaW5nW10ge1xuICByZXR1cm4gYXJyWzBdID09PSAnc3RyaW5nJztcbn1cblxuZnVuY3Rpb24gaXNMb2MoXG4gIGl0ZW06IHN0cmluZ1tdIHwgQVNULlNvdXJjZUxvY2F0aW9uIHwgQVNULk11c3RhY2hlQ29tbWVudFN0YXRlbWVudFtdIHwgdW5kZWZpbmVkXG4pOiBpdGVtIGlzIEFTVC5Tb3VyY2VMb2NhdGlvbiB7XG4gIHJldHVybiAhQXJyYXkuaXNBcnJheShpdGVtKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICBtdXN0YWNoZTogYnVpbGRNdXN0YWNoZSxcbiAgYmxvY2s6IGJ1aWxkQmxvY2ssXG4gIHBhcnRpYWw6IGJ1aWxkUGFydGlhbCxcbiAgY29tbWVudDogYnVpbGRDb21tZW50LFxuICBtdXN0YWNoZUNvbW1lbnQ6IGJ1aWxkTXVzdGFjaGVDb21tZW50LFxuICBlbGVtZW50OiBidWlsZEVsZW1lbnQsXG4gIGVsZW1lbnRNb2RpZmllcjogYnVpbGRFbGVtZW50TW9kaWZpZXIsXG4gIGF0dHI6IGJ1aWxkQXR0cixcbiAgdGV4dDogYnVpbGRUZXh0LFxuICBzZXhwcjogYnVpbGRTZXhwcixcbiAgcGF0aDogYnVpbGRQYXRoLFxuICBjb25jYXQ6IGJ1aWxkQ29uY2F0LFxuICBoYXNoOiBidWlsZEhhc2gsXG4gIHBhaXI6IGJ1aWxkUGFpcixcbiAgbGl0ZXJhbDogYnVpbGRMaXRlcmFsLFxuICBwcm9ncmFtOiBidWlsZFByb2dyYW0sXG4gIGxvYzogYnVpbGRMb2MsXG4gIHBvczogYnVpbGRQb3NpdGlvbixcblxuICBzdHJpbmc6IGxpdGVyYWwoJ1N0cmluZ0xpdGVyYWwnKSxcbiAgYm9vbGVhbjogbGl0ZXJhbCgnQm9vbGVhbkxpdGVyYWwnKSxcbiAgbnVtYmVyOiBsaXRlcmFsKCdOdW1iZXJMaXRlcmFsJyksXG4gIHVuZGVmaW5lZCgpIHtcbiAgICByZXR1cm4gYnVpbGRMaXRlcmFsKCdVbmRlZmluZWRMaXRlcmFsJywgdW5kZWZpbmVkKTtcbiAgfSxcbiAgbnVsbCgpIHtcbiAgICByZXR1cm4gYnVpbGRMaXRlcmFsKCdOdWxsTGl0ZXJhbCcsIG51bGwpO1xuICB9LFxufTtcblxuZnVuY3Rpb24gbGl0ZXJhbDxUIGV4dGVuZHMgQVNULkxpdGVyYWw+KHR5cGU6IFRbJ3R5cGUnXSkge1xuICByZXR1cm4gZnVuY3Rpb24odmFsdWU6IFRbJ3ZhbHVlJ10pIHtcbiAgICByZXR1cm4gYnVpbGRMaXRlcmFsKHR5cGUsIHZhbHVlKTtcbiAgfTtcbn1cbiJdfQ==